# unityTips. 外部サービス活用
________________________________________
## 1. スプレッドシート活用Tips

1. csvダウンロードをワンクリックでできるEditor拡張を用意
2. スプレッドシート側は複数シートを自動的に1つにまとめるシートを用意してそれをDL

1つにまとめる例

```text
=QUERY(
{
'01アリス'!B1:F;
'02ボブ'!B2:F;
'03キャロル'!B2:F
},
"SELECT * WHERE Col1 IS NOT NULL",
1)
```

IDの自動採番

```text
=IF(B2<>"",TEXT(B2,"000")&"0"&D2,"")
```

補足：スプシで範囲を文字列結合した場合

- 行ごとに結合した結果になる（SQL的）
- 範囲の行数が違うと、その行はN/Aになる（SQLのNULL的）
- 1列のみの範囲と2列以上の範囲で結合すると、1列のみのほうが両方の列に結合する
- 複数の列同士の場合、以下のような結果になる
    - 1範囲目の1列目&2範囲目の1列目、1範囲目の2列目&2範囲目の2列目、というような結果になる
    - 対応する列が存在しない（列数が不一致する列）は全てN/Aとなる

________________________________________
## 2. データフォーマットの使い分け

1. csv : （スプレッドシート上で管理される）台詞データなど
2. xml : 手でメンテナンスする入れ子構造のあるコマンド機構
3. json : 専用のエディタ等から出力・自動生成されるデータ